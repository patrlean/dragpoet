<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- <meta http-equiv="refresh" content="3"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>拼贴诗词</title>
    <link href="style.css" type="text/css" rel="stylesheet" />
</head>
<body>
    <div id="拼词页面">
        <div id="开头文字">
            动动小手从虚框中pick词语开始创作叭~
        </br>
        </div>
        <div id="outerBox">
            <span id="量子力学" class="verse" onclick="myFunction(this)" style="background-color: white;">量子力学</span>
            <span id="品学楼" class="verse" onclick="myFunction(this)" style="background-color: white;">品学楼</span>
            <span id="我" class="verse" onclick="myFunction(this)" style="background-color: white;">我</span>
            <span id="爱" class="verse" onclick="myFunction(this)" style="background-color: white;">爱</span>
            <span id="他一" class="verse" onclick="myFunction(this)" style="background-color: white;">他</span>
            <span id="她" class="verse" onclick="myFunction(this)" style="background-color: white;">她</span>
            <span id="麦克斯韦雕像" class="verse" onclick="myFunction(this)" style="background-color: white;">麦克斯韦雕像</span>
            <span id="学子餐厅" class="verse" onclick="myFunction(this)" style="background-color: white;">学子餐厅</span>
            <span id="夕阳" class="verse" onclick="myFunction(this)" style="background-color: white;">夕阳</span>
            <span id="平行宇宙" class="verse" onclick="myFunction(this)" style="background-color: white;">平行宇宙</span>
            <span id="是" class="verse" onclick="myFunction(this)" style="background-color: white;">是</span>
            <span id="的一" class="verse" onclick="myFunction(this)" style="background-color: white;">的</span>
            <span id="心" class="verse" onclick="myFunction(this)" style="background-color: white;">心</span>
            <span id="让我们在一起" class="verse-double" onclick="myFunction(this)" style="background-color: white;">让我们<br/>在一起</span>
            <span id="的二" class="verse" onclick="myFunction(this)" style="background-color: white;">的</span>
            <span id="他二" class="verse" value='0' onclick="myFunction(this)" style="background-color: white;" style="background-color: white;">他</span>
            <span id="永远" class="verse" onclick="myFunction(this)" style="background-color: white;">永远</span>
            <span id="故事" class="verse" onclick="myFunction(this)" style="background-color: white;">故事</span>
            <span id="ta" class="verse" onclick="myFunction(this)" style="background-color: white;">ta</span>
            <span id="小狗" class="verse" onclick="myFunction(this)" style="background-color: white;">小狗</span>
        </div>

        <div>
            <button type="button" class="按钮" onclick="generateSentence()">生成句子！</button>
            <button type="button" class="按钮" onclick="someMagic()">一点灵感？</button>
        </div>
        <div hidden="hidden">
            <canvas id="myCanvas" width="300" height="400" style="border:2px dashed #000000;"></canvas>
        </div>
    </div>

    <div id="输出图像" style="display: none">
        <img>
    </div>
    
<script>
    // 变量定义
    var wordSet = new Array();
    var img = new Image();
    const WORDNON = ['量子力学'];
    const WORDCONJ = [''];
    const WORDSTATE = ['让我们在一起'];
    // 函数
    // 加入新词
    function myFunction(obj) {
        elem = document.getElementById(obj.id);
        newWord = elem.innerText;
        // console.log(elem.style.backgroundColor);
        if (elem.style.backgroundColor == "white"){
            elem.style.backgroundColor = "rgb(243, 236, 176)";
            wordSet.push(newWord);
        }
        else{
            elem.style.backgroundColor = "white";
            const index = wordSet.indexOf(newWord);
            if (index > -1) { // 移除找到的指定元素
            wordSet.splice(index, 1); // 移除元素
            }
        }
    }

    // 生成句子
    function generateSentence() {
        // 组合句子
        sentence = wordSet.join("");
        // alert(sentence);
        // 创建canvas绘图元素
        var c = document.getElementById('myCanvas');
        var ctx = c.getContext('2d');
        var w = c.width;
        var h = c.height;
        c.width = w;
        c.height = h;
        ctx.fillStyle = "rgb(27, 28, 32)";
        ctx.font="14px Arial";
        ctx.fillText(sentence,10,50);
        // 生成图像
        var dataImg = new Image()
        dataImg.src = c.toDataURL('image/png',1.0);
        var page = document.getElementById("拼词页面");
        page.style.display = "none";
        var imgPage = document.getElementById("输出图像");
        imgPage.style.display = "flex";
        imgPage.innerHTML = '<img src="' + dataImg.src + '" alt="">';
        
    }
    
    // 一点灵感
    function someMagic() {
        
    }
    // Converts canvas to an image
    function convertCanvasToImage(canvas) {
        var image = new Image();
        image.src = canvas.toDataURL("image/png");
        return image;
    }
</script>
</body>
</html>